# سیستم همگام‌سازی Real-Time

## توضیحات
این سیستم امکان به‌روزرسانی خودکار سایت اصلی را هنگام تغییرات در پنل ادمین فراهم می‌کند.

## ویژگی‌ها

### 🔄 همگام‌سازی خودکار
- **محصولات**: هنگام اضافه، ویرایش یا حذف محصول در پنل ادمین
- **تنظیمات**: هنگام تغییر اطلاعات تماس یا متن‌های درباره ما
- **مقالات**: هنگام اضافه، ویرایش یا حذف مقاله

### 📱 پشتیبانی از چندین تب
- همگام‌سازی بین تب‌های مختلف مرورگر
- همگام‌سازی در همان تب (برای تجربه بهتر)

### ⚡ عملکرد بهینه
- همگام‌سازی فوری با Storage Events
- همگام‌سازی پشتیبان هر 30 ثانیه
- نمایش اعلان‌های زیبا برای کاربر

## نحوه کارکرد

### 1. Storage Events
```javascript
window.addEventListener('storage', (e) => {
    if (e.key === 'honartaneh_products') {
        // همگام‌سازی محصولات
    }
});
```

### 2. Custom Events
```javascript
window.dispatchEvent(new CustomEvent('productsUpdated', {
    detail: { products: products }
}));
```

### 3. Timestamp Sync
```javascript
localStorage.setItem('lastSyncTime', Date.now().toString());
```

## فایل‌های تغییر یافته

### `script.js`
- اضافه شدن کلاس `RealTimeSync`
- همگام‌سازی خودکار محصولات و تنظیمات
- نمایش اعلان‌های همگام‌سازی

### `admin/admin-script.js`
- به‌روزرسانی توابع `saveProducts()`, `saveSettings()`, `saveBlogPosts()`
- اضافه شدن timestamp و custom events

### `products.html`
- همگام‌سازی مخصوص صفحه محصولات
- اعلان‌های مخصوص این صفحه

## تست کردن

### مراحل تست:
1. سایت اصلی را در یک تب باز کنید
2. پنل ادمین را در تب دیگری باز کنید
3. محصول جدیدی اضافه کنید
4. مشاهده کنید که محصول فوراً در سایت اصلی ظاهر می‌شود

### اعلان‌های همگام‌سازی:
- ✨ محصولات به‌روزرسانی شدند
- ⚙️ تنظیمات به‌روزرسانی شدند
- 📝 مقالات به‌روزرسانی شدند

## نکات مهم

### محدودیت‌ها:
- همگام‌سازی فقط در همان دامنه کار می‌کند
- نیاز به localStorage فعال دارد
- در حالت incognito ممکن است محدود باشد

### بهینه‌سازی:
- همگام‌سازی فقط در صورت تغییر واقعی انجام می‌شود
- استفاده از JSON.stringify برای مقایسه تغییرات
- حذف خودکار اعلان‌ها پس از 4 ثانیه

## پشتیبانی مرورگرها

- ✅ Chrome 4+
- ✅ Firefox 3.5+
- ✅ Safari 4+
- ✅ Edge 12+
- ✅ Opera 10.5+

## عیب‌یابی

### اگر همگام‌سازی کار نمی‌کند:
1. بررسی کنید که localStorage فعال باشد
2. Console را برای خطاها بررسی کنید
3. مطمئن شوید که هر دو تب در همان دامنه هستند
4. مرورگر را refresh کنید

### لاگ‌های مفید:
```javascript
console.log('🔄 محصولات به‌روزرسانی شدند - همگام‌سازی...');
console.log('⚙️ تنظیمات به‌روزرسانی شدند - همگام‌سازی...');
console.log('📝 مقالات به‌روزرسانی شدند - همگام‌سازی...');
```
